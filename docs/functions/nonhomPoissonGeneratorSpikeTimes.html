<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of nonhomPoissonGeneratorSpikeTimes</title>
  <meta name="keywords" content="nonhomPoissonGeneratorSpikeTimes">
  <meta name="description" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html functions -->
<h1>nonhomPoissonGeneratorSpikeTimes
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong></strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function S = nonhomPoissonGeneratorSpikeTimes(S_ini,rate,tau,kick,N,interval,dt) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="getBurstGating.html" class="code" title="function [sext,tstart,Ptot,sources_eg]=getBurstGating(T,freq,width,num_spikes,dc,num_targets,minIBI,meanIBI,tau,kick,kernel,shared_sources_flag,onset,offset,ramp_dc_flag,ramp_ac_flag,num_sources)">getBurstGating</a>	T=0:.01:1000; f=10; w=10; nspk=10; dc=0; Npop=2; minIBI=0; meanIBI=0; [sext,ts,Ptot,Peg]=getBurstGating(T,f,w,nspk,dc,Npop,minIBI,meanIBI,2,1,ones(1,Npop),0,0,inf,0,0,1);</li><li><a href="getGenExtPoissonTotalGating.html" class="code" title="function S = getGenExtPoissonTotalGating_jss(tOn,tOff,latency_,freq_,normFreqSigma_,phase_,widthSigma,rate_baseline,rate_dc_,rate_ac_,tau,kick,N,interval,dt,conn,ramp_dc_flag,ramp_ac_flag)">getGenExtPoissonTotalGating</a>	16-Feb-2016: JSS</li><li><a href="getPopRhythmGating.html" class="code" title="function [sext,tstart,Pinputs,Psource,conn,T,lambda]=getPopRhythmGating(num_sources,num_targets,prob_conn,cell_FR,pop_freq,width,T,onset,offset,tau_syn,kick,seed,mask,ac_type)">getPopRhythmGating</a>	function [sext,tstart,Pinputs,Psource,conn,T]=getPopRhythmGating(num_sources,num_targets,prob_conn,cell_FR,pop_freq,width,T,onset,offset,tau_syn,kick,seed,mask,ac_type)</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function S = nonhomPoissonGeneratorSpikeTimes(S_ini,rate,tau,kick,N,interval,dt)</a>
0002   nt = 1+ceil(interval/dt);
0003   S = zeros(N,nt);
0004   <span class="keyword">for</span> i=1:N
0005     <span class="comment">% Determine number of events in each time bin</span>
0006     p = poissrnd(max(rate(i,:),0)*dt);
0007     <span class="comment">% Get the proper length for the events</span>
0008     l = sum(p);
0009     timeevents = zeros(1,l+1);
0010     <span class="comment">% For each dt compute the event times</span>
0011     ix = find(p); <span class="comment">% p diff than 0</span>
0012     cum = cumsum([1 p(ix)]);
0013     adds = diff([0 ix-1]);
0014     timeevents(cum(1:end-1)) = adds;
0015     timeevents(cum(end):end) = inf; <span class="comment">% no more spikes after that</span>
0016     timeevents = cumsum(timeevents); <span class="comment">% in dt units</span>
0017     timeevents = dt*sort(timeevents+rand(size(timeevents)));<span class="comment">% in each dt unit, the spike can happen anytime, with uniform distribution</span>
0018 
0019     S_tmp = S_ini(i);
0020     spikeTimePointer = 1;
0021     nextSpikeTime = timeevents(spikeTimePointer);
0022 
0023     time = 0;
0024     <span class="keyword">for</span> t = 1:nt
0025       time = time + dt;
0026       decayTime = dt;
0027       indSpikeNow = (nextSpikeTime&lt;=time);
0028       <span class="keyword">while</span> indSpikeNow
0029         decayTime = dt + (nextSpikeTime - time);
0030         S_tmp = S_tmp.*exp(-decayTime/tau);
0031         S_tmp = S_tmp + kick;
0032         decayTime = time - nextSpikeTime;
0033 
0034         spikeTimePointer = spikeTimePointer+1;
0035         nextSpikeTime = timeevents(spikeTimePointer);
0036         indSpikeNow = (nextSpikeTime&lt;=time);
0037       <span class="keyword">end</span>
0038       S_tmp = S_tmp.*exp(-decayTime/tau);
0039       S(i,t) = S_tmp;
0040     <span class="keyword">end</span>
0041   <span class="keyword">end</span>
0042 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Fri 24-Feb-2017 14:46:35 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>